<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FileEcho - File Manager Web GUI</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="ai_addon.css">
</head>
<body oncontextmenu="return false;">
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="/logo.ico" alt="FileEcho" class="logo-icon">
                    <span class="logo-text">FileEcho</span>
                    <span class="badge rounded-pill bg-primary">v1.1.1-AI Embedded</span>
                </div>
            </div>

            <div class="sidebar-scroll">
                <div class="panel">
                    <div class="panel-header">
                        <i class="fas fa-language"></i> <span data-i18n="language">Language</span>
                    </div>
                    <div class="setting-row">
                        <select id="language-select" class="form-select-custom">
                            <option value="en">English</option>
                            <option value="zh">简体中文</option>
                        </select>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <i class="fas fa-palette"></i> <span data-i18n="theme">Theme</span>
                    </div>
                    <div class="setting-row">
                        <select id="theme-select" class="form-select-custom">
                            <option value="light" data-i18n="themeLight">Default Light</option>
                            <option value="obsidian" data-i18n="themeObsidian">Obsidian</option>
                            <option value="sublime" data-i18n="themeSublime">Sublime</option>
                            <option value="windows" data-i18n="themeWindows">Windows Dark</option>
                            <option value="dracula" data-i18n="themeDracula">Dracula</option>
                            <option value="space" data-i18n="themeSpace">Deep Space</option>
                        </select>
                    </div>
                </div>

                <div class="panel info-panel">
                    <div class="panel-header">
                        <i class="fas fa-chart-pie"></i> <span data-i18n="fileInfo">File Info</span>
                    </div>
                    <div class="info-content">
                        <div class="info-item" title="Current Path">
                            <i class="fas fa-folder-open"></i>
                            <span id="current-path" class="text-ellipsis" data-i18n="noPathSelected">No path selected</span>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-file-alt"></i>
                            <span id="file-count">0</span> <span data-i18n="files">Files</span>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-hdd"></i>
                            <span id="total-size">0 B</span>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <i class="fas fa-search"></i> <span data-i18n="targetAddress">Target Address</span>
                    </div>
                    <div class="search-container">
                        <div class="search-row-1">
                            <input type="text" id="directory-path" class="form-control-compact" data-i18n-placeholder="pathPlaceholder" placeholder="Absolute path...">
                            <button id="scan-btn" class="btn btn-primary btn-sm btn-icon-only search-btn" title="Scan">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <div class="search-row-2">
                            <input type="file" id="folder-selector" webkitdirectory directory hidden>
                            <button id="select-folder-btn" class="btn btn-outline-primary btn-sm btn-icon-only" title="Select Folder">
                                <i class="fas fa-folder-open"></i>
                            </button>
                            <div class="spacer"></div>
                            <button id="clear-btn" class="btn btn-outline-danger btn-sm btn-icon-only" title="Clear All">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <i class="fas fa-sliders-h"></i> <span data-i18n="settings">Settings</span>
                    </div>
                    <div class="settings-grid">
                        <div class="setting-row">
                            <label for="max-depth" data-i18n="maxDepth">Max Depth</label>
                            <input type="number" id="max-depth" value="-1" min="-1" class="form-control-compact">
                        </div>
                        <div class="setting-row">
                            <label for="exclude-patterns" data-i18n="excludes">Excludes</label>
                            <input type="text" id="exclude-patterns" data-i18n-placeholder="excludesPlaceholder" placeholder="node_modules, .git" class="form-control-compact">
                        </div>
                        <div class="setting-row checkbox-row">
                            <input type="checkbox" id="show-size" checked>
                            <label for="show-size" data-i18n="showSize">Show Size</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sidebar-footer">
                <button id="github-btn" class="btn btn-github w-100">
                    <i class="fab fa-github"></i> <span data-i18n="viewOnGitHub">View on GitHub</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="main-content">
            <header class="top-bar">
                <div class="top-bar-left">
                    <button id="sidebar-toggle-btn" class="toggle-btn-main">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
                <div class="top-bar-right">
                    <div class="status-bar">
                        <span id="status-indicator" class="status-indicator active"></span>
                        <span id="server-status">Connected</span>
                        <span id="api-status" class="api-version"></span>
                    </div>
                </div>
            </header>

            <div class="content-split">
                <!-- Left: Tree View -->
                <section class="split-column tree-section">
                    <div class="column-header">
                        <h3><i class="fas fa-stream"></i> <span data-i18n="treeView">File Tree</span></h3>
                    </div>
                    <div class="tree-viewport">
                        <pre id="tree-output" data-i18n="treePlaceholder">Enter path in sidebar and scan.</pre>
                    </div>
                    <div class="column-actions-bar">
                        <button id="generate-tree-btn" class="btn btn-outline-secondary btn-sm flex-fill">
                            <i class="fas fa-sync"></i> <span data-i18n="refresh">Refresh</span>
                        </button>
                        <button id="copy-btn" class="btn btn-outline-secondary btn-sm flex-fill">
                            <i class="fas fa-copy"></i> <span data-i18n="copy">Copy</span>
                        </button>
                        <button id="download-btn" class="btn btn-outline-secondary btn-sm flex-fill">
                            <i class="fas fa-download"></i> <span data-i18n="download">Download</span>
                        </button>
                    </div>
                </section>

                <!-- Resizer -->
                <div id="resizer" class="resizer"></div>

                <!-- Right: File List -->
                <section class="split-column list-section">
                    <div class="column-header">
                        <h3><i class="fas fa-list"></i> <span data-i18n="listView">File Details</span></h3>
                        <div class="filter-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="list-filter" data-i18n-placeholder="filterPlaceholder" placeholder="Filter current list (Press Enter to prune tree)...">
                        </div>
                    </div>
                    <div class="table-viewport">
                        <table class="table table-sm table-hover sticky-header">
                            <thead>
                                <tr>
                                    <th data-sort="name"><span data-i18n="name">Name</span> <i class="sort-icon fas fa-sort"></i></th>
                                    <th data-sort="size" class="col-size"><span data-i18n="size">Size</span> <i class="sort-icon fas fa-sort"></i></th>
                                    <th data-sort="depth" class="col-depth"><span data-i18n="depth">Depth</span> <i class="sort-icon fas fa-sort"></i></th>
                                </tr>
                            </thead>
                            <tbody id="file-table-body">
                                <tr>
                                    <td colspan="3" class="empty-message">No files scanned yet</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <div id="toast-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
    <script src="ai_addon.js"></script>
    <script>
    // Disable browser shortcuts (refresh, devtools, save, print, etc.)
    document.addEventListener('keydown', function(e) {
        // F5 / Ctrl+R / Ctrl+Shift+R  — Refresh
        if (e.key === 'F5' || (e.ctrlKey && e.key === 'r')) { e.preventDefault(); return; }
        // F12 / Ctrl+Shift+I / Ctrl+Shift+J — DevTools
        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'i' || e.key === 'J' || e.key === 'j'))) { e.preventDefault(); return; }
        // Ctrl+U — View Source
        if (e.ctrlKey && (e.key === 'u' || e.key === 'U')) { e.preventDefault(); return; }
        // Ctrl+S — Save
        if (e.ctrlKey && !e.shiftKey && (e.key === 's' || e.key === 'S')) { e.preventDefault(); return; }
        // Ctrl+P — Print
        if (e.ctrlKey && (e.key === 'p' || e.key === 'P')) { e.preventDefault(); return; }
        // Ctrl+G — Go to line (browser)
        if (e.ctrlKey && (e.key === 'g' || e.key === 'G')) { e.preventDefault(); return; }
        // Ctrl+F5 / Ctrl+Shift+R — Hard refresh
        if (e.ctrlKey && e.key === 'F5') { e.preventDefault(); return; }
        // F7 — Caret browsing
        if (e.key === 'F7') { e.preventDefault(); return; }
    });
    </script>
</body>
</html>